<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <link type="text/css" rel="stylesheet" href="../css/header.css">
  <link type="text/css" rel="stylesheet" href="../css/common.css">
  <link type="text/css" rel="stylesheet" href="../css/receivings.css">
  <link type="text/css" rel="stylesheet" href="../css/sidebar.css">
    <script type="text/javascript" src="../js/sidebar.js"></script>
  <title>자재입고</title>
</head>
<body>
  <div th:insert="~{common/sidebar :: sidebar}"></div>
	<div class="main-content">
		<div th:insert="~{common/header :: header}"></div>
		<div id="row2">
    <div id="planList">
      <h2 class="visual-title">입고예정품목</h2>
      <div class="search-container">
        <label for="dateInput"></label>
        <input type="date" id="dateInput">

        <!-- 드롭다운 메뉴로 필터 선택 -->
        <select id="filterSelect">
            <option value="itemCode">품목코드</option>
            <option value="itemName">품목명</option>
        </select>
        <!-- 검색 입력 필드 -->
        <input type="text" id="searchInput" placeholder="검색어를 입력하세요">
        <!-- 검색 버튼 -->
        <button onclick="performSearch()" class="blueBtn">검색</button>
      </div>

      <table class="list-table" id="res">
        <colgroup>
          <col width="11%">
          <col width="11%">
          <col width="10%">
          <col width="7%">
          <col width="7%">
          <col width="7%">
          <col width="7%">
          <col width="7%">
          <col width="5%">
        </colgroup>
        <tr>
          <th> 품목코드</th>
          <th> 품목명</th>
          <th> 재질</th>
          <th> 기입고수량</th>
          <th> 발주수량</th>
          <th> 발주일</th>
          <th> 납기일</th>
          <th> 최근납기일</th>
          <th> 현황</th>
        </tr>
        <th:block th:each="receiving : ${receivings}">
        <tr>
          <td th:text="${receiving.orders.contract.item.itemCode}"></td>
          <td th:text="${receiving.orders.contract.item.itemName}"></td>
          <td th:text="${receiving.orders.contract.item.material}"></td>
          <td th:text="${receiving.receiveQuantity}"></td> 
          <td>500</td> <!-- 발주서.발주수량 가져오기 // 수정필요! -->
          <td>2024-05-20</td> <!-- 발주서.발주서발행일 // 수정필요! -->
          <td th:text="${receiving.orders.contract.lead_time}"></td>  <!-- 계약 : 납기일 -->
          <td></td>
          <td><input type="button" value="입고" class="blueBtn" onclick="receivingStrat(this)"></td>
        </tr>
      </table>  
    </div>
  </div>
    <div id="row1">
      <h2 class="visual-title">자재입고</h2>
       <table class="regi-table" id="receivingTable">
        <colgroup>
          <col width="20%">
          <col width="25%">
          <col width="20%">
          <col width="20%">
          <col width="10%">
        </colgroup>
        <tr>
          <th> 품목코드</th>
          <th> 품목명</th>
          <th> 기입고수량</th>
          <th> 발주수량</th>
          <th> 입고수량</th>
        
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td><input type="text"></td>
        </tr>
      </table>  
      <div class="button_wrap">
        <button type="submit" class="blueBtn">저장</button>
        <button type="button" class="blueBtn">마감</button>
      </div>
    </div>
 
</div>
  <script>
  	function receivingStrat(button){
  		var row = button.parentElement.parentElement;  //부모태그의 부모태그를 반환(td -> tr!)
  		
  		var itemCode = row.cells[0].innerText;
  		var itemName = row.cells[1].innerText;
  		var wQuantity = row.cells[3].innerText; //기입고수량
  		var orderedQuantity = row.cells[4].innerText; //발주수량
  	
  		
  		var receivingTable = document.getElementById("receivingTable"); //하단 테이블(자재입고) 찾음
	  	  var firstRow = receivingTable.rows[1]; // 첫 번째 데이터 행을 참조
	
	      firstRow.cells[0].innerText = itemCode;
	      firstRow.cells[1].innerText = itemName;
	      firstRow.cells[2].innerText = wQuantity; // 기입고수량 초기값 설정
	      firstRow.cells[3].innerText = orderedQuantity;
	      firstRow.cells[4].innerHTML = '<input type="number" value="0">'; // 입고수량 입력 필드 추가
	 }
        
  		
  </script>

  <script>
    function performSearch() {
        var filter = document.getElementById('filterSelect').value;
        var searchText = document.getElementById('searchInput').value.trim();
        alert("검색 필터: " + filter + "\n검색어: " + searchText);
        // 실제 검색 로직 구현 필요
    }
    </script>
</body>
</html>