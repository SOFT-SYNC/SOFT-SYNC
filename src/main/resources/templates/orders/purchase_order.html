<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<link type="text/css" rel="stylesheet" href="../CSS/header.css">
<link type="text/css" rel="stylesheet" href="../CSS/common.css">
<link type="text/css" rel="stylesheet" href="../CSS/sidebar.css">
<link type="text/css" rel="stylesheet" href="../CSS/order.css">
  <script type="text/javascript" src="../js/sidebar.js"></script>

</head>
<body>
	<div th:insert="~{common/sidebar :: sidebar}"></div>
	<div class="main-content">
		<div th:insert="~{common/header :: header}"></div>
		<div id="row1">
			<h2 class="visual-title">구매 발주서</h2>
			<div>
			<button type="submit" id="popupBtn" onclick="openNewWindow()" class="blueBtn">발주서 발행</button>
			</div>
			<!-- (상단)구매발주서  테이블-->
			
			<table class="table">
			<colgroup>
			<col width="10%">
			<col width="40%">
			<col width="10%">
			<col width="40%">
			</colgroup>
			<tbody>
                  <tr>
                     <th>발주번호</th>
                     <td th:text="${orders.orderNo}">발주번호출력</td>
                     <th>등록번호</th>
                     <td th:text="${orders.orderNo">등록번호 출력</td>
                  </tr>
                  <tr>
                     <th>발신처</th>
                     <td><b>(주) SOFT-SYNC</b></td>
                     <th>수신처</th>
                     <td th:text="${company.BRN}">수신처 출력</td>
                  </tr>
                  <tr>
                     <th>연락처</th>
                     <td>031-5555-5555</td>
                     <th>대표자명</th>
                     <td th:text="${company.companyCeo}">대표자명 출력</td>
                  </tr>
                  <tr>
                     <th>발주일</th>
                     <td>[[${#temporals.format(orders.regDate, 'yyyy/MM/dd')}]]</td>
                     <th>주소</th>
                     <td th:text="${company.address}">주소 출력</td>
                  </tr>
                  <tr>
                     <th>납기일</th>
                     <td th:text="${orders.receiveDuedate}">납기일 출력</td>
                     <th>담당자</th>
                     <td th:text="${company.manager}">담당자 출력</td>
                  </tr>
                  <tr>
                     <th>지불조건</th>
                     <td>지불조건 출력</td>
                     <th>연락처</th>
                     <td th:text="${company.phone}">연락처 출력</td>
                  </tr>
                  </tbody>
			</table>

			<div id="centertb">
				<table class="listTable">
					<thead>
						<tr>
							<th>번호</th>
							<th>품명</th>
							<th>규격</th>
							<th>단위</th>
							<th>수량</th>
							<th>단가</th>
							<th>공급가액</th>
							<th>비고</th>
						</tr>
						<tr>
							<td></td>
							<td th:text ="${items.name}"></td>
							<td th:text ="${items.dimensions}"></td>
							<td>EA</td>
							<td> <input type="number" ></td>
							<td th:text= "${contract.price}"></td>
							<td>총금액</td>
							<td th:text="${orders.orderNote}"></td>
						</tr>
					</thead>
				</table>
			</div>
		</div>
		<div id="row2">
			<h2 class="visual-title">
				발주 품목 조회
				</h2>
				<!-- (하단)발주 품목 조회 리스트 scope -->
				<div id="bottomtb">
					<input type="date"> ~ <input type="date">
					<button type="submit" class="blueBtn">검색</button>
					<a href="purchase_order_list">
						<button type="button" class="blueBtn">목록</button>
					</a>
					<!-- list가 null이거나 비어있는 경우 -->
					<div th:if ="${orderList == null}">
					
					</div>
					<table class="listTable">
						<thead>
							<tr>
								<th>품목코드</th>
								<th>품목명</th>
								<th>재질</th>
								<th>발주수량</th>
								<th>발주일</th>
								<th>납기일</th>
							</tr>
						</thead>
						<tbody>
						    <tr th:each="item : ${orderList}">
				              <td th:text="${item.code}">품목코드</td>
				              <td th:text="${item.name}">품목명</td>
				              <td th:text="${item.material}">재질</td>
				              <td th:text="${item.quantity}">발주수량</td>
				              <td th:text="${item.orderDate}">발주일</td>
				              <td th:text="${item.deliveryDate}">납기일</td>
				          	</tr>
						</tbody>
					</table>
					<div id="newTableContainer"></div>
					<!-- 새로운 테이블이 표시될 컨테이너 -->
					
				</div>
		</div>
	</div>
	<div id="modalWrap">
		<div id="modalBody">
			<button type="button" class="closeBtn">&times;</button>
			<div>
				<table>
					<colgroup>
					</colgroup>
					<tbody>
						<tr></tr>
					</tbody>
				</table>
			</div>
<button type="submit" class="blueBtn">인쇄</button>
		</div>
	</div>

<script>
const popupBtn = document.getElementById("popupBtn"); // 팝업 버튼 요소 가져오기
const modalWrap = document.getElementById("modalWrap"); // 모달 요소 가져오기
const closeBtn = document.querySelector(".closeBtn"); // 모달 닫기 버튼 요소 가져오기
const modalImage = document.getElementById("modalImage");

// 팝업 버튼 클릭 시 모달 열기
popupBtn.addEventListener("click", function() {
  modalWrap.style.display = "block";
});

// 모달 닫기 버튼 클릭 시 모달 닫기
closeBtn.addEventListener("click", function() {
  modalWrap.style.display = "none";
});

// 모달 외부 클릭 시 모달 닫기
window.addEventListener("click", function(event) {
  if (event.target === modalWrap) {
    modalWrap.style.display = "none";
  }
});


};


    // 더미 데이터 정의
    var dummyData = [
        { key: "발주번호", value: "123456" },
        { key: "등록번호", value: "789012" },
        { key: "발신처", value: "ABC 회사" },
        { key: "수신처", value: "XYZ 회사" },
        { key: "연락처", value: "010-1234-5678" },
        { key: "대표자명", value: "홍길동" },
        { key: "발주일", value: "2024-05-20" },
        { key: "주소", value: "서울시 강남구" },
        { key: "납기일", value: "2024-06-10" },
        { key: "담당자", value: "이몽룡" },
        { key: "지불조건", value: "카드 결제" },
        { key: "연락처", value: "010-5678-1234" }
    ];
    
    // 새 창을 열어 발주서 출력하는 함수
    function openNewWindow() {
        var width = 900;
        var height = 700;
        var left = (window.screen.width - width) / 2;
        var top = (window.screen.height - height) / 2;
    
        var newWindow = window.open("", "_blank", "width=" + width + ", height=" + height + ", left=" + left + ", top=" + top);
        
        // 제목 중앙 정렬
        newWindow.document.write("<h4 style='text-align: center;'>발주서</h4>");
    
        // 첫 번째 테이블 생성
        var table1 = document.createElement("table");
        table1.style.border = "1px solid #ddd"; // 테두리 스타일 추가
        table1.style.margin = "0 auto"; // 가운데 정렬
        table1.style.width = "70%"; // 너비 설정
        var tbody1 = document.createElement("tbody");
    
        for (var i = 0; i < dummyData.length; i += 2) {
            var row = document.createElement("tr");
            row.innerHTML = `
                <th style='border: 1px solid #ddd; padding: 8px;'>${dummyData[i].key}</th>
                <td style='border: 1px solid #ddd; padding: 8px;'>${dummyData[i].value}</td>
                <th style='border: 1px solid #ddd; padding: 8px;'>${dummyData[i + 1].key}</th>
                <td style='border: 1px solid #ddd; padding: 8px;'>${dummyData[i + 1].value}</td>
            `;
            tbody1.appendChild(row);
        }
    
        table1.appendChild(tbody1);
    
        // 새 창에 첫 번째 테이블 추가
        newWindow.document.body.appendChild(table1);

        // 두 번째 테이블 생성
        var table2 = document.createElement("table");
        table2.style.border = "1px solid #ddd"; // 테두리 스타일 추가
        table2.style.margin = "0 auto"; // 가운데 정렬
        table2.style.width = "70%"; // 너비 설정
        table2.innerHTML = `
            <thead>
                <tr>
                    <th style='border: 1px solid #ddd; padding: 8px;'>번호</th>
                    <th style='border: 1px solid #ddd; padding: 8px;'>품명</th>
                    <th style='border: 1px solid #ddd; padding: 8px;'>규격</th>
                    <th style='border: 1px solid #ddd; padding: 8px;'>단위</th>
                    <th style='border: 1px solid #ddd; padding: 8px;'>수량</th>
                    <th style='border: 1px solid #ddd; padding: 8px;'>단가</th>
                    <th style='border: 1px solid #ddd; padding: 8px;'>공급가액</th>
                    <th style='border: 1px solid #ddd; padding: 8px;'>비고</th>
                </tr>
                <tr>  
                    <td style='border: 1px solid #ddd; padding: 8px;'>1</td>
                    <td style='border: 1px solid #ddd; padding: 8px;'>상품A</td>
                    <td style='border: 1px solid #ddd; padding: 8px;'>규격A</td>
                    <td style='border: 1px solid #ddd; padding: 8px;'>개</td>
                    <td style='border: 1px solid #ddd; padding: 8px;'>10</td>
                    <td style='border: 1px solid #ddd; padding: 8px;'>10000</td>
                    <td style='border: 1px solid #ddd; padding: 8px;'>100000</td>
                    <td style='border: 1px solid #ddd; padding: 8px;'>비고</td>
                </tr>
            </thead>
        `;
        newWindow.document.body.appendChild(table2);
    }
</script>

</body>
</html>