<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<link type="text/css" rel="stylesheet" href="../css/common/header.css">
<link type="text/css" rel="stylesheet" href="../css/common/common.css">
<link type="text/css" rel="stylesheet" href="../css/common/sidebar.css">
<link type="text/css" rel="stylesheet"
	href="../css/orders/purchase_schedule.css">
<script type="text/javascript" src="../js/sidebar.js"></script>
<script type="text/javascript" src="../js/Inspection.js"></script>
</head>
<body>
	<div th:insert="~{common/sidebar :: sidebar}"></div>
	<div th:insert="~{common/header :: header}"></div>
	<div class="main-content">
		<div id="row1">
			<form id="inspectionForm"
				onsubmit="event.preventDefault(); addToMainTable();">
				<div id="toptb">
					<h1 class="visual-title">진척검수</h1>
					<div class="btn-container">
						<button type="button" class="blueBtn">검수마감</button>
						<button type="button" class="blueBtn"
							onclick="location.href='purchase_schedule'">초기화</button>
					</div>
					<table class="table" id="mainTable">
						<colgroup>
							<col width="15%">
							<col width="20%">
							<col width="20%">
							<col width="15%">
							<col width="15%">
							<col width="15%">
						</colgroup>
						<thead>
							<tr>
								<th>발주번호</th>
								<th>발주일</th>
								<th>입고예정일</th>
								<th>품목코드</th>
								<th>품명</th>
								<th>발주수량</th>
							</tr>
						</thead>
						<tbody>
						</tbody>
					</table>
					<table class="inspecPlanList table" id="createtb">
						<colgroup>
							<col width="8%">
							<col width="8%">
							<col width="15%">
							<col width="15%">
							<col width="10%">
							<col width="10%">
							<col width="10%">
							<col width="8%">
						</colgroup>
						<thead>
							<tr>
								<th>일정번호</th>
								<th>차수</th>
								<th>검수예정일</th>
								<th>검수일</th>
								<th>발주량</th>
								<th>생산량</th>
								<th>진행률</th>
								<!-- <th>비고</th> -->
								<th>진행</th>
							</tr>
						</thead>
						<tbody>
						</tbody>
					</table>
				</div>
			</form>
			<h2 class="visual-title">진척검수 일정 등록</h2>
			<form>
				<table class="inspecPlanRegi listTable">
					<colgroup>
						<col width="10%">
						<col width="40%">
						<col width="35%">
						<col width="15%">
					</colgroup>
					<tr>
						<th>차수</th>
						<th>검수예정일</th>
						<th>생산량</th>
						<th>등록/취소</th>
					</tr>
					<tr>
						<td><input type="number" id="times"></td>
						<td><input type="date" id="duedate"></td>
						<td><input type="text" id="quantity"></td>
						<td>
							<button type="button" class="addBtn blueBtn"
								onclick="registerInspection()">등록</button>
							<button type="reset" class="blueBtn">취소</button>
						</td>
					</tr>
				</table>
			</form>
		</div>
		<div id="row2">
			<h2 class="visual-title">검수 예정 품목</h2>
			<table class="listTable">
				<colgroup>
					<col width="12%">
					<col width="15%">
					<col width="15%">
					<col width="15%">
					<col width="13%">
					<col width="10%">
					<col width="10%">
					<col width="10%">
				</colgroup>
				<thead>
					<tr>
						<th>발주번호</th>
						<th>발주일</th>
						<th>입고예정일</th>
						<th>품목코드</th>
						<th>품명</th>
						<th>발주수량</th>
						<th>검수현황</th>
						<th>검수</th>
					</tr>
					<tr th:each="order : ${orders}"
						th:if="${order.receiptYn == 'Y' and order.contract != null}">
						<td th:text="${order.orderNo}"></td>
						<td th:text="${order.orderDate}"></td>
						<td th:text="${order.receiveDuedate}"></td>
						<td th:text="${order.contract.item.itemCode}"></td>
						<td th:text="${order.contract.item.itemName}"></td>
						<td th:text="${order.orderQuantity}"></td>
						<td></td>
						<td><input type="button" value="검수" class="blueBtn"></td>
					</tr>
				</thead>
			</table>
		</div>
	</div>
</body>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function(){
    // "검수" 버튼이 클릭되었을 때의 이벤트 핸들러
    $(".blueBtn").on("click", function(){
        // 클릭된 버튼의 부모 행(tr)을 선택하여 해당 행에 있는 데이터를 가져옴
        var $row = $(this).closest("tr");
        var orderNo = $row.find("td:eq(0)").text(); // 발주번호
        var orderDate = $row.find("td:eq(1)").text(); // 발주일
        var receiveDuedate = $row.find("td:eq(2)").text(); // 입고예정일
        var itemCode = $row.find("td:eq(3)").text(); // 품목코드
        var itemName = $row.find("td:eq(4)").text(); // 품명
        var orderQuantity = $row.find("td:eq(5)").text(); // 발주수량
        
        // 새로운 행을 생성하여 데이터를 삽입
        var newRow = "<tr>";
        newRow += "<td>" + orderNo + "</td>";
        newRow += "<td>" + orderDate + "</td>";
        newRow += "<td>" + receiveDuedate + "</td>";
        newRow += "<td>" + itemCode + "</td>";
        newRow += "<td>" + itemName + "</td>";
        newRow += "<td>" + orderQuantity + "</td>";
        newRow += "</tr>";
        
        // 새로운 행을 테이블의 tbody에 추가
        $("#mainTable tbody").append(newRow);
    });
});
</script>
</html>
